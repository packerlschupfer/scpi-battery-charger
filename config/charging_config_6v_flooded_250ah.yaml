# Battery Charger Configuration - 6V Flooded 250Ah Golf Cart
# Common for: Heavy duty golf carts, industrial floor machines
# Flooded deep-cycle batteries - 3 cells (6V nominal)
# NOTE: 20A charger limit - ideal would be 25A (0.1C)

power_supply:
  model: "OWON SPE6205"
  port: "/dev/ttyUSB0"
  baudrate: 115200
  timeout: 5.0
  max_voltage: 60.0
  max_current: 20.0
  max_power: 500.0

battery:
  type: "lead_acid_flooded_deep_cycle"
  model: "Generic 6V 250Ah Golf Cart"
  nominal_voltage: 6.0
  capacity: 250.0
  chemistry: "lead_antimony"        # Golf cart batteries often use lead-antimony
  maintenance_free: false

charging:
  default_mode: "IUoU"

  IUoU:
    bulk_current: 20.0             # Limited by PSU (0.08C, slower than ideal)
    absorption_voltage: 8.1        # 2.7V/cell × 3
    float_voltage: 6.75            # 2.25V/cell × 3
    absorption_current_threshold: 2.0
    absorption_timeout: 7200
    enable_float: true

  IUoU_Recovery:
    bulk_current: 20.0
    absorption_voltage: 8.25       # Slightly higher for recovery
    absorption_duration: 10800
    float_voltage: 6.75
    absorption_current_threshold: 1.6
    enable_float: true

  CV:
    voltage: 8.0
    max_current: 20.0
    min_current: 2.0

  CC:
    current: 20.0
    max_voltage: 8.25

  Conditioning:
    voltage: 8.25                  # Equalization voltage
    max_current: 20.0
    duration: 86400
    electrolysis_warning: 1.0

  Pulse:
    pulse_voltage: 8.25
    pulse_current: 20.0
    rest_voltage: 6.75
    pulse_duration: 20
    rest_duration: 40
    max_cycles: 30

  Trickle:
    voltage: 6.75
    current: 2.0

safety:
  absolute_max_voltage: 8.5        # 2.83V/cell × 3
  absolute_max_current: 20.0
  min_voltage: 5.25                # 1.75V/cell × 3
  warning_voltage: 6.0             # 2.0V/cell × 3
  max_charging_duration: 43200
  max_temperature: 45.0
  min_temperature: 0.0
  measurement_interval: 5.0
  log_interval: 60.0
  plateau_detection:
    enabled: true
    threshold_voltage: 8.25
    time_window: 900
    voltage_delta: 0.05
  charging_efficiency: 0.83

temperature:
  enabled: false
  sensor_type: "ds18b20"
  sensor_id: null

mqtt:
  enabled: true
  broker: "localhost"
  port: 1883
  username: ""
  password: ""
  client_id: "battery-charger"
  base_topic: "battery-charger"
  qos: 1
  retain: true
  update_interval: 5.0
  lwt_topic: "battery-charger/status/online"
  lwt_payload: "false"

logging:
  enabled: true
  log_dir: "logs"
  format: "csv"
  max_files: 30
  fields:
    - timestamp
    - voltage
    - current
    - power
    - ah_delivered
    - wh_delivered
    - ah_stored
    - mode
    - state
    - stage
    - elapsed
    - progress

notifications:
  console_enabled: true
  notify_on_start: true
  notify_on_complete: true
  notify_on_error: true
  notify_on_safety_limit: true
